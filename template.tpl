___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Opticks Sensor",
  "categories": [
    "AFFILIATE_MARKETING",
    "ADVERTISING",
    "MARKETING"
  ],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Opticks",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Opticks invalid traffic detection and ad-fraud solution.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "sensorId",
    "displayName": "Opticks Sensor ID",
    "simpleValueType": true,
    "help": "This value is unique to your Opticks account. You can get it from the \"Sensor JS\" section inside the Opticks app. It will be an identifier similar to \"12a34b5c6d7e8f9g\".",
    "alwaysInSummary": true
  },
  {
    "type": "GROUP",
    "name": "groupAdvanced",
    "displayName": "Advanced Configuration",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "PARAM_TABLE",
        "name": "macros",
        "displayName": "Additional Segmentation Parameters (macros)",
        "paramTableColumns": [
          {
            "param": {
              "type": "SELECT",
              "name": "macro",
              "displayName": "Opticks macro",
              "macrosInSelect": false,
              "selectItems": [
                {
                  "value": "var1",
                  "displayValue": "var1"
                },
                {
                  "value": "var2",
                  "displayValue": "var2"
                },
                {
                  "value": "var3",
                  "displayValue": "var3"
                },
                {
                  "value": "var4",
                  "displayValue": "var4"
                },
                {
                  "value": "external_id",
                  "displayValue": "external_id"
                }
              ],
              "simpleValueType": true
            },
            "isUnique": true
          },
          {
            "param": {
              "type": "TEXT",
              "name": "value",
              "displayName": "Value",
              "simpleValueType": true
            },
            "isUnique": false
          }
        ],
        "newRowButtonText": "Add macro mapping",
        "help": "Opticks automatically captures all parameters in the Page URL as macros, including any available UTM such as \"utm_source\".  Here you can configure additional macros to send to Opticks, for example to send values stored in the Data Layer."
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

var injectScript = require('injectScript');
var encodeUri = require('encodeUri');
var encodeUriComponent = require('encodeUriComponent');

var domain = 'https://opticksprotection.com';
var url = domain + '/o/' + encodeUri(data.sensorId);

if (data.macros) {
  for (var i = 0; i < data.macros.length; ++i) {
    url += (i === 0 ? '?' : '&') + encodeUriComponent(data.macros[i].macro) + '=' + encodeUriComponent(data.macros[i].value || '');
  }
}

injectScript(url, data.gtmOnSuccess, data.gtmOnFailure);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://opticksprotection.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 2/3/2025, 4:22:18 PM


